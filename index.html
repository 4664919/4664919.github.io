<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>simons blog</title>
  <meta name="author" content="simon sun">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="simons blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon" type="image/x-ico">
  <link rel="alternate" href="/atom.xml" title="simons blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">simons blog</a></h1>
  <h2 class="subtitle"></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/about">About</a></li>
    
      <li><a href="/atom.xml">RSS</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-08-28T06:26:10.000Z"><a href="/hello-world.html">2015-08-28</a></time>
      
      
  
    <h1 class="title"><a href="/hello-world.html">Hello World</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2><h3 id="Create_a_new_post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="[layout]">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-08-28T06:06:08.000Z"><a href="/postName.html">2015-08-28</a></time>
      
      
  
    <h1 class="title"><a href="/postName.html">postName</a></h1>
  

    </header>
    <div class="entry">
      
        
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-06-08T10:02:29.000Z"><a href="/vim_vim_search_ag-vim.html">2015-06-08</a></time>
      
      
  
    <h1 class="title"><a href="/vim_vim_search_ag-vim.html">vim搜索插件ag.vim</a></h1>
  

    </header>
    <div class="entry">
      
        <div>之前使用vim搜索特别麻烦，vim自带的vimgrep速度慢，而且不好用。</div><br><div></div><br><div>先安装 the_silver_searcher</div><br><div>brew install the_silver_searcher</div><br><div></div><br><div>vim下配置：</div><br><div>Bundle &#8216;<a href="https://github.com/rking/ag.vim" target="_blank" rel="external">https://github.com/rking/ag.vim</a>&#8216;</div><br><div>let g:ackprg = &#8216;ag &#8211;nogroup &#8211;nocolor &#8211;column&#8217;</div><br><div></div><br><div></div><br><div>git地址传送门</div><br><div><a href="https://github.com/rking/ag.vim" target="_blank" rel="external">https://github.com/rking/ag.vim</a></div><br><div></div><br><div></div><br><div></div>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-06-08T10:00:12.000Z"><a href="/golang_http_get_post.html">2015-06-08</a></time>
      
      
  
    <h1 class="title"><a href="/golang_http_get_post.html">golang http get、post实例</a></h1>
  

    </header>
    <div class="entry">
      
        <p>生活中我们有很多代码格式是固定的，轮子造好后应该去创造其他东西，而不是重复造轮子。所以以下golang方式get、post做一个记录。以后可以直接copy使用</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">     <span class="string">"fmt"</span></span><br><span class="line">     <span class="string">"io/ioutil"</span></span><br><span class="line">     <span class="string">"net/http"</span></span><br><span class="line">     <span class="string">"net/url"</span></span><br><span class="line">     <span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">     <span class="keyword">var</span> sender = <span class="string">"simonsun"</span></span><br><span class="line">     v := url.Values&#123;&#125;</span><br><span class="line">     v.Set(<span class="string">"type"</span>, <span class="string">"tip"</span>)</span><br><span class="line">     v.Add(<span class="string">"sender"</span>, sender)</span><br><span class="line">     v.Add(<span class="string">"recvusers"</span>, sender)</span><br><span class="line">     v.Add(<span class="string">"message"</span>, <span class="string">"骚年，你好content"</span>)</span><br><span class="line">     v.Add(<span class="string">"title"</span>, <span class="string">"骚年，你好title"</span>)</span><br><span class="line">     v.Add(<span class="string">"pwd"</span>, <span class="string">"123456"</span>)</span><br><span class="line">     <span class="keyword">var</span> url_info = <span class="string">"http://rtx.oa.com:8013/service/index.php?"</span> + v.Encode()</span><br><span class="line">     fmt.Println(url_info)</span><br><span class="line">     <span class="comment">//get 方式</span></span><br><span class="line">     resp, err := http.Get(url_info)</span><br><span class="line">     <span class="comment">//post 方式</span></span><br><span class="line">     <span class="comment">//resp, err := http.PostForm("http://rtx.oa.com:8012/service/index.php", v)</span></span><br><span class="line">     <span class="keyword">if</span> err == <span class="constant">nil</span> &#123;</span><br><span class="line">          body, err := ioutil.ReadAll(resp.Body)</span><br><span class="line">          <span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line">          <span class="keyword">if</span> err == <span class="constant">nil</span> &#123;</span><br><span class="line">               fmt.Println(<span class="typename">string</span>(body))</span><br><span class="line">               fmt.Println(err)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">               fmt.Println(<span class="string">"parse io read error"</span>, err)</span><br><span class="line">          &#125;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          fmt.Println(<span class="string">"http rtx error http error:"</span>, err)</span><br><span class="line">     &#125;</span><br><span class="line">     os.Exit(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-05-08T15:29:40.000Z"><a href="/architecture_how_to_use_beanstalk.html">2015-05-08</a></time>
      
      
  
    <h1 class="title"><a href="/architecture_how_to_use_beanstalk.html">beanstalk介绍以及使用说明</a></h1>
  

    </header>
    <div class="entry">
      
        <div>使用beanstalk也有一年了，今天准备对项目的beanstalk进行封装，顺带纪录一个日志说明下</div><br><div></div><br><div>功能描述：</div><br><div>     beanstalk是一个异步的队列服务，目标是把复杂、耗时的任务放到后端去执行。提升前端响应时间。确切的说这里说的前端、后端 就是beanstalk的producer-consumer，一个负责丢任务，一个负责完成任务</div><br><div>使用场景：</div><br><div>     需要进行异步操作的任务都可以放到beanstalk中</div><br><div>业务实例：</div><br><div>     比如发邮件、短信等。可以直接丢入队列，然后服务端去依次发送</div><br><div>     比如电商中的业务、行为分析等操作，</div><br><div></div><br><div>具体使用方式：</div><br><div></div><br><div>一个任务的典型生命流程很简单：</div><br><pre class="EnlighterJSRAW" data-enlighter-language="null">put （丢任务，生产者）  reserve（取任务，消费者）        delete（删除）<br>-&gt; [READY]beanstalk的状态-&gt; [RESERVED]beanstalk的状态—&gt; 生命周期完成</pre><br><div></div><br><div></div><br><div>producer中创建任务，put后producer生命周期就结束了</div><br><div>consumer负责干活。一般取出任务后删除即可。取出任务之前是ready状态。取出任务后就reserve状态。删除后任务就清掉了。</div><br><div></div><br><div>完整的生命周期:</div><br><div></div><br><div><a href="/wp-content/uploads/2015/05/0DE6ACB1-70AB-412B-A3EB-AC8520B51D9A.png"><img src="http://dev.blog.simonsun.net/wp-content/uploads/2015/05/0DE6ACB1-70AB-412B-A3EB-AC8520B51D9A.png" alt="0DE6ACB1-70AB-412B-A3EB-AC8520B51D9A"></a></div><br><div>Beanstalkd中完整的任务的生命周期。一个job有READY, RESERVED, DELAYED, BURIED四种状态。当producer直接put一个job时，job就处于READY状态，等待consumer来处理，如果选择延迟 put，job就先到DELAYED状态，等待时间过后才迁移到READY状态。consumer获取了当前READY的job后，该job的状态就迁移 到RESERVED，这样其他的consumer就不能再操作该job。当consumer完成该job后，可以选择delete, release或者bury操作;delete之后，job从系统消亡，之后不能再获取;release操作可以重新把该job状态迁移回READY(也 可以延迟该状态迁移操作)，使其他的consumer可以继续获取和执行该job;有意思的是bury操作，可以把该job休眠，等到需要的时候，再将休 眠的job kick回READY状态，也可以delete BURIED状态的job。正是有这些有趣的操作和状态，才可以基于此做出很多意思的应用，比如要实现一个循环队列，就可以将RESERVED状态的 job休眠掉，等没有READY状态的job时再将BURIED状态的job一次性kick回READY状态。</div><br><div></div><br><div>任务的状态：</div><br><div>ready     等待状态，任务在等待consumer执行</div><br><div>reserved     任务准备状态，当任务从tube中取出来（包括准备取出来）时，这个任务就是reserved状态，其他consumer将取不到此任务</div><br><div>delayed      延时状态，任务在指定时间之后才会变为ready状态</div><br><div>buried       等待kick，通常是任务失败为此状态</div><br><div></div><br><div></div><br><div></div><br><div>参数说明：</div><br><div></div><br><div>pri &#8211; priority(优先级) － 支持0到2**32的优先级，值越小，优先级越高，默认优先级为1024。</div><br><div>ttr &#8211; time to run(任务执行时间) － 允许consumer执行这个任务的时间</div><br><div>delay － 定时执行的时间，秒为单位</div><br><div></div><br><div></div><br><div>命令列表：</div><br><div><br><div>生产者使用命令</div><br><div>－－－－－－－－－－－－－－－－－－</div><br><div></div><br><div>put</div><br><div>写入一个任务</div><br><pre class="EnlighterJSRAW" data-enlighter-language="null">put &lt;pri&gt; &lt;delay&gt; &lt;ttr&gt; &lt;bytes&gt;\r\n<br>&lt;data&gt;\r\n</pre><br><div></div><br><div></div><br><div>use</div><br><div>切换队列</div><br><div><br><pre class="EnlighterJSRAW" data-enlighter-language="null">use &lt;tube&gt;\r\n</pre><br></div><br><div></div><br><div>消费者使用命令</div><br><div>－－－－－－－－－－－－－－－－</div><br><div></div><br><div>reserve</div><br><div>取一个任务</div><br><div><br><pre class="EnlighterJSRAW" data-enlighter-language="null">reserve\r\n</pre><br></div><br><div></div><br><div>取一个任务，带超时时间的</div><br><div><br><pre class="EnlighterJSRAW" data-enlighter-language="null">reserve-with-timeout &lt;seconds&gt;\r\n</pre><br></div><br><div></div><br><div></div><br><div></div><br><div>delete</div><br><div>删除一个任务</div><br><div><br><pre class="EnlighterJSRAW" data-enlighter-language="null">delete &lt;id&gt;\r\n</pre><br></div><br><div></div><br><div>release</div><br><div>把任务重新置为ready状态</div><br><div><br><pre class="EnlighterJSRAW" data-enlighter-language="null">release &lt;id&gt; &lt;pri&gt; &lt;delay&gt;\r\n</pre><br></div><br><div></div><br><div></div><br><div>bury</div><br><div>不常用，将任务置为buried状态。</div><br><div><br><pre class="EnlighterJSRAW" data-enlighter-language="null">bury &lt;id&gt; &lt;pri&gt;\r\n</pre><br></div><br><div></div><br><div>touch</div><br><div>告诉beanstalk这个任务还在继续执行，防止取出任务超时后，beanstalk认为失败</div><br><div><br><pre class="EnlighterJSRAW" data-enlighter-language="null">touch &lt;id&gt;\r\n</pre><br></div><br><div></div><br><div>watch</div><br><div>不常用，似乎是使消费者同时从多个任务中取数据</div><br><div><br><pre class="EnlighterJSRAW" data-enlighter-language="null">watch &lt;tube&gt;\r\n</pre><br></div><br><div></div><br><div>ignore</div><br><div>不常用，与watch匹配一起使用，是从watch list中删除一个任务</div><br><div><br><pre class="EnlighterJSRAW" data-enlighter-language="null">ignore &lt;tube&gt;\r\n</pre><br></div><br><div></div><br><div></div><br><div></div><br><div>－－Other Commands－－</div><br><pre class="EnlighterJSRAW" data-enlighter-language="null">peek<br>kick<br>kick-job<br>stats-job<br>stats-tube<br>stats<br>list-tubes<br>list-tube-used<br>list-tubes-watched<br>quit</pre><br><div></div><br><div></div><br></div><br><div></div><br><div>以下是我对队列封装类的函数，其实就是执行beanstalk的命令</div><br><div><br><div>   public static function addWorker()</div><br><div>   public static function delete()</div><br><div>   public static function doWork()</div><br><div>   public static function get()</div><br><div>   public static function put()</div><br><div>   public static function release()</div><br><div>   public static function touch()</div><br></div><br><div></div><br><div> 使用起来也非常简单，一般一条语句就可以，很方便</div><br><div></div><br><div></div><br><div></div><br><div></div><br><div></div><br><div></div><br><div></div><br><div></div><br><div></div>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-05-08T15:21:34.000Z"><a href="/linux_linux_shell_read.html">2015-05-08</a></time>
      
      
  
    <h1 class="title"><a href="/linux_linux_shell_read.html">巧用read 让你的shell更人性化</a></h1>
  

    </header>
    <div class="entry">
      
        <p>先来张图热乎一下：<br><a href="/wp-content/uploads/2015/05/7DF97234-0661-465F-8256-51D0809709DF.png"><img src="http://dev.blog.simonsun.net/wp-content/uploads/2015/05/7DF97234-0661-465F-8256-51D0809709DF.png" alt="7DF97234-0661-465F-8256-51D0809709DF"></a></p>
<p>我们使用shell read让shell更人性化，使用方便还高大上。<br>read使用方式很简单， 直接［read 变量］ 即可</p>
<p>来个demo：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="built_in">read</span> -p “Enter your name:” name</span><br><span class="line"><span class="built_in">echo</span> “hello <span class="variable">$name</span>, welcome to my program”</span><br><span class="line"><span class="built_in">exit</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>具体参数</p>
<p>Read可以带有-a, -d, -e, -n, -p, -r, -t, 和 -s八个选项。<br>-a ：将内容读入到数值中<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n “Input muliple values into an array:”</span><br><span class="line"><span class="built_in">read</span> <span class="operator">-a</span> array</span><br><span class="line"><span class="built_in">echo</span> “get \&#123;<span class="variable">$#array</span>[@]\&#125; values <span class="keyword">in</span> array”</span><br></pre></td></tr></table></figure></p>
<p>-d ：表示delimiter，即定界符，一般情况下是以IFS为参数的间隔，但是通过-d，我们可以定义一直读到出现执行的字符位置。例如read –d madfds value，读到有m的字符的时候就不在继续向后读，例如输入为 hello m，有效值为“hello”，请注意m前面的空格等会被删除。这种方式可以输入多个字符串，例如定义“.”作为结符号等等。</p>
<p>-e ：只用于互相交互的脚本，它将readline用于收集输入行。读到这几句话不太明白什么意思，先跳过。</p>
<p>-n ：用于限定最多可以有多少字符可以作为有效读入。例如echo –n 4 value1 value2，如果我们试图输入12 34，则只有前面有效的12 3，作为输入，实际上在你输入第4个字符‘3’后，就自动结束输入。这里结果是value为12，value2为3。</p>
<p>-p ：用于给出提示符，在前面的例子中我们使用了echo –n “…“来给出提示符，可以使用read –p ‘… my promt?’value的方式只需一个语句来表示。</p>
<p>-r ：在参数输入中，我们可以使用’/’表示没有输入完，换行继续输入，如果我们需要行最后的’/’作为有效的字符，可以通过-r来进行。此外在输入字符中，我们希望/n这类特殊字符生效，也应采用-r选项。</p>
<p>-s ：对于一些特殊的符号，例如箭头号，不将他们在terminal上打印，例如read –s key，我们按光标，在回车之后，如果我们要求显示，即echo，光标向上，如果不使用-s，在输入的时候，输入处显示^[[A，即在terminal上 打印，之后如果要求echo，光标会上移。</p>
<p>-t ：用于表示等待输入的时间，单位为秒，等待时间超过，将继续执行后面的脚本，注意不作为null输入，参数将保留原有的值</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-05-08T14:32:26.000Z"><a href="/javascript-cross-origin-resource-sharing.html">2015-05-08</a></time>
      
      
  
    <h1 class="title"><a href="/javascript-cross-origin-resource-sharing.html">造成跨域的原因，以及解决办法</a></h1>
  

    </header>
    <div class="entry">
      
        <p>今天同事过来问我一个问题：当js请求跨域的时候，服务器端能否接收到数据，如果能接收到数据是否是半链接？</p>
<p>我忽然发现我不知道改怎么回答这个问题，因为之前确实没有关注这个问题。</p>
<p>仔细想了一下并且查了相关资料做了测试结果为：</p>
<p>造成跨域的原因是js安全策略做的限制，http、浏览器是没有限制的。也就是说服务端是会有返回并且客户端也会接收数据只是js不认。</p>
<p>so重点是js，所以我们只要能绕过js安全策略即可。</p>
<p>基于这个，目前解决跨域问题的方法有如下：</p>
<p>设置domain</p>
<p>jsonp</p>
<p>form、iframe</p>
<p>cors</p>
<p>domain 这个使用最简单，使用频率也是最高的，同时限制也是很大的。它只能解决本域的跨域</p>
<p>jsonp 原理很简单，就是创建一个url地址去请求，然后返回的时候返回字符串内容，然后根据约定把返回的内容转换为js即可。jsonp使用频率很高，不过它的限制是不能post数据，所以不安全。</p>
<p>form、iframe 是很早之前使用的方式，在ajax之前就是用这个方法解决跨域的。介个很老了，现在很少用到它了</p>
<p>cors   这个是新解决办法，只需要在header里配置一下就可以解决跨域问题。很方便也很简单。不过由于比较新很多老浏览器不支持，下图是各个浏览器的支持情况。</p>
<p>&nbsp;</p>
<p><img src="/wp-content/uploads/2015/05/06082033-9233ced009a644f9af909baca57a72b7.png" alt=""></p>
<p><img src="/wp-content/uploads/2015/05/06082103-f46e697e71884240b7200f8713697fbc.png" alt=""></p>
<p>网上介绍跨域的代码有很多，所以这里只写原理。代码就不重复造轮子了。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-05-07T09:59:45.000Z"><a href="/arithmetic-binary-search.html">2015-05-07</a></time>
      
      
  
    <h1 class="title"><a href="/arithmetic-binary-search.html">算法 － 二分查找(Binary Search)</a></h1>
  

    </header>
    <div class="entry">
      
        <div class="g-mn"><br><div class="posts"><br><div class="m-post article"><br><div class="box"><br><div class="cont"><br><div class="text"><br><br>前言：<br><br>算法时间复杂度按优劣排差不多集中在：<br><br>O(1), O(log n), O(n), O(n log n), O(n2), O(nk), O(2n)<br><br>到目前位置，似乎我学到的算法中，时间复杂度是O(log n),好像就数二分查找法，其他的诸如排序算法都是 O(n log n)或者O(n2)。但是也正是因为有二分的 O(log n), 才让很多 O(n2)缩减到只要O(n log n)。<br><br>作用：<br><br>二分查找法主要是解决在“一堆数中找出指定的数”这类问题。<br><br>条件：<br><br>想要应用二分查找法，这“一堆数”必须有一下特征：<br><br>存储在数组中<br><br>有序排列<br><br>搜索值必须在数组中<br><br>原理：<br><br>二分查找算法就是不断将数组进行对半分割，每次拿中间元素和goal进行比较。<br><br>代码示例：<br><br>php:<br><br><pre class="EnlighterJSRAW" data-enlighter-language="php">&lt;?php<br><br>$array = array(1,3,4,6,6,6,7,8,9,10);<br><br>$search = 9;<br><br>$res = binarySearch($array,$search);<br><br>var_dump($res);<br><br>/<em>*

</em> 二分查找(binary search)<br><br><em> 返回搜索值在数组中的位置，如搜索不到返回false

</em>/<br><br>function binarySearch($array ,$search) {<br><br>$high = count($array) - 1;<br><br>$low = 0 ;<br><br>//搜索值不存在于数组中则搜索不到<br><br>if($search &lt; $array[$low] || $search &gt; $array[$high]){<br><br>return false ;<br><br>}<br><br>while ($low &lt;= $high){<br><br>//取中间位置<br><br>$mid = floor($low + ($high - $low)/2) ;<br><br>if($array[$mid]&gt;$search){//如果搜索值小于当前中间位置，则设置最大边界为当前中间位置－1<br><br>$high = $mid - 1 ;<br><br>}else if($array[$mid]&lt;$search){//如果搜索值大于当前中间位置，则设置最小边界为当前边界＋1<br><br>$low  = $mid + 1 ;<br><br>}else{<br><br>//不大于也不小于就是等于了<br><br>return $mid ;<br><br>}<br><br>}<br><br>return false ;<br><br>}</pre><br><br>golang:<br><br><pre class="EnlighterJSRAW" data-enlighter-language="null">package main<br><br>import (<br><br>“errors”<br><br>“fmt”<br><br>)<br><br>func main() {<br><br>var array []int = []int{1, 3, 4, 6, 6, 6, 7, 8, 9, 10}<br><br>var search int = 9<br><br>var pos int<br><br>var err error<br><br>pos, err = binarySearch(array, search)<br><br>fmt.Println(pos)<br><br>fmt.Println(err)<br><br>}<br><br>func binarySearch(array []int, search int) (pos int, err error) {<br><br>var low int = 0<br><br>var high int = len(array) - 1<br><br>var middle int<br><br>for low &lt;= high {<br><br>//取中间位置<br><br>middle = low + (high-low)/2<br><br>//如果搜索值小于当前中间位置，则设置最大边界为当前中间位置－1<br><br>if array[middle] &gt; search {<br><br>high = middle - 1<br><br>continue<br><br>}<br><br>//如果搜索值大于当前中间位置，则设置最小边界为当前边界＋1<br><br>if array[middle] &lt; search {<br><br>high = middle - 1<br><br>continue<br><br>}<br><br>//如果搜索值大于当前中间位置，则设置最小边界为当前边界＋1<br><br>if array[middle] &lt; search {<br><br>low = middle + 1<br><br>continue<br><br>}<br><br>//不大于也不小于就是等于了<br><br>if array[middle] == search {<br><br>return middle, nil<br><br>}<br><br>}<br><br>return -1, errors.New(“not find”)<br><br>}</pre><br><br>缺陷：<br><br>二分查找法的O(log n)让它成为十分高效的算法。不过它的缺陷却也是那么明显的。就在它的限定之上：<br><br>必须有序，我们很难保证我们的数组都是有序的。当然可以在构建数组的时候进行排序，可是又落到了第二个瓶颈上：它必须是数组。<br><br>数组读取效率是O(1)，可是它的插入和删除某个元素的效率却是O(n)。因而导致构建有序数组变成低效的事情。<br><br></div><br></div><br></div><br></div><br></div><br></div>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-05-07T09:52:10.000Z"><a href="/eight-queens-puzzle-testing-with-language.html">2015-05-07</a></time>
      
      
  
    <h1 class="title"><a href="/eight-queens-puzzle-testing-with-language.html">八皇后问题在各语言下执行时间测试</a></h1>
  

    </header>
    <div class="entry">
      
        <p>前几天公司内部同事想测试下语言的效率，当时使用八皇后问题进行测试（实际应用中代码都为九皇后），</p>
<p>目前测试覆盖的代码有 C,GO,JAVA,PHP</p>
<p>待写测试代码的有：PYTHON,RUBY,NODEJS,JS</p>
<p>目前效率最高的是C语言，其次是GO，然后是JAVA，最慢的是PHP</p>
<p>其中C语言在优化后可达到1毫秒，未优化2毫秒</p>
<p>GO运行在2-3毫秒之间</p>
<p>JAVA为4毫秒</p>
<p>PHP达到80毫秒左右，开APC达到56毫秒，通过查看OPCODE各种优化达到40毫秒（这时候已经影响到可读性了）</p>
<p>附效率截图：</p>
<p>优化后的C</p>
<p><img src="/wp-content/uploads/2015/05/43C2D95475FD89063F422CE2781EE8E7_B500_900_193_63.jpeg" alt=""></p>
<p>未优化的C</p>
<p><img src="/wp-content/uploads/2015/05/EB8ED5CA077B7346D2773AEE4A02A153_B500_900_208_62.jpeg" alt=""></p>
<p>JAVA</p>
<p><img src="/wp-content/uploads/2015/05/6717B942A8DFEF9B4B43FBD149EEAB83_B500_900_279_65.jpeg" alt=""></p>
<p>开启APC后的PHP</p>
<p><img src="/wp-content/uploads/2015/05/5E8F0D435B879E1E62108CFB4B0F8DFC_B500_900_320_61.jpeg" alt=""></p>
<p>未开启APC的PHP</p>
<p><img src="/wp-content/uploads/2015/05/D05B76E3515309E44374C0A288335E9E_B500_900_322_69.jpeg" alt=""></p>
<p>&nbsp;</p>
<p>golang:</p>
<p>total results: 352</p>
<p>total time: 2</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-05-07T09:51:12.000Z"><a href="/golang-daemon.html">2015-05-07</a></time>
      
      
  
    <h1 class="title"><a href="/golang-daemon.html">golang 守护进程 daemon 实现方式</a></h1>
  

    </header>
    <div class="entry">
      
        <p>技术点：</p>
<ul>
<li>执行代码增加了一个开关，用来判断是否已经是daemon形式启动了</li>
<li>使用linux内置守护进程运行命令</li>
</ul>
<p>具体逻辑：</p>
<p>程序在刚启动的时候包中init函数优先执行，执行后验证是否存在守护进程开关，如果存在并且当前进程不是守护进程模式则使用守护进程方式启动应用并退出当前进程</p>
<p>需要注意的：golang的flag包的逻辑是所有参数必须都是flag方式，否则就不解析。我在做的时候是有非flag方式的，所以只能自己动手丰衣足食了</p>
<p>伪代码示例：</p>
<p>包：</p>
<p>func init(){</p>
<p>//验证是否存在守护进程开关</p>
<p>if daemon_args_exist(){</p>
<p>//当前进程不是守护进程模式</p>
<p>if ! is_daemon_progress() {</p>
<p>//守护进程方式启动应用</p>
<p>star_daemon()</p>
<p>//并退出当前进程</p>
<p>os.Exit(0)</p>
<p>}</p>
<p>}</p>
<p>&nbsp;</p>
<p>}</p>
<p>应用入口main：</p>
<p>import(</p>
<p>//只要引入包即可，无需其他操作</p>
<p>_ “xidibuy/daemon&#8221;</p>
<p>)</p>
<p>另外下面传送门的这个git是有bug的，当有参数不全部为flag的时候，就会失效。</p>
<p>思路参考了： <a href="http://github.com/icattlecoder/godaemon" target="_blank" rel="external">github.com/icattlecoder/godaemon</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-05-07T09:19:46.000Z"><a href="/why-write-blog.html">2015-05-07</a></time>
      
      
  
    <h1 class="title"><a href="/why-write-blog.html">首篇博客说明 以及为什么写博客</a></h1>
  

    </header>
    <div class="entry">
      
        <p>断断续续写了几年的博客，每个阶段的开始也是一个新博客的开启。期望不会再变动博客了，之前写的博客会酌情挪动到此博客下，一些质量不高的就抛弃了。</p>
<p>关于为什么写博客，之前博客盛行一时到之后的衰落，我当年也是跟风写了一点。由于各种原因博客总是断掉，其中最重要的原因是当时不知道博客存在的价值。直到读《暗示间》、《把时间当作朋友》（不记得到底是哪一本了）时才知道博客的核心价值。这也是我重新写博客的原因和动力。</p>
<p>那么博客的核心价值是什么呢？ 个人觉得主要是减少沟通成本。其他人想了解我们可以通过观看我们的博客从而了解我们，而我们博客只写一次可以让所有人来观看。</p>
<p>其次我们自己也可以通过观看自己的博客了解曾经的我们的所知所想。</p>
<p>最后，曾经用过wordpress，后来觉得不好用，放弃了。结果最后还是用它了。新版的wordpress很好用！～</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





<nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜尋">
    <input type="hidden" name="q" value="site:blog.simonsun.net">
  </form>
</div>

  

  
<div class="widget tag">
  <h3 class="title">最新文章</h3>
  <ul class="entry">
    
      <li>
        <a href="/hello-world.html">Hello World</a>
      </li>
    
      <li>
        <a href="/postName.html">postName</a>
      </li>
    
      <li>
        <a href="/vim_vim_search_ag-vim.html">vim搜索插件ag.vim</a>
      </li>
    
      <li>
        <a href="/golang_http_get_post.html">golang http get、post实例</a>
      </li>
    
      <li>
        <a href="/architecture_how_to_use_beanstalk.html">beanstalk介绍以及使用说明</a>
      </li>
    
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">標籤</h3>
  <ul class="entry">
  
    <li><a href="/tags/VIM插件/">VIM插件</a><small>1</small></li>
  
    <li><a href="/tags/ag-vim/">ag.vim</a><small>1</small></li>
  
    <li><a href="/tags/ajax/">ajax</a><small>1</small></li>
  
    <li><a href="/tags/beanstalk/">beanstalk</a><small>1</small></li>
  
    <li><a href="/tags/daemon/">daemon</a><small>1</small></li>
  
    <li><a href="/tags/go/">go</a><small>1</small></li>
  
    <li><a href="/tags/golang/">golang</a><small>3</small></li>
  
    <li><a href="/tags/javascript/">javascript</a><small>1</small></li>
  
    <li><a href="/tags/linux/">linux</a><small>2</small></li>
  
    <li><a href="/tags/php/">php</a><small>2</small></li>
  
    <li><a href="/tags/queue/">queue</a><small>1</small></li>
  
    <li><a href="/tags/shell/">shell</a><small>1</small></li>
  
    <li><a href="/tags/vim/">vim</a><small>1</small></li>
  
    <li><a href="/tags/二分查找/">二分查找</a><small>1</small></li>
  
    <li><a href="/tags/前端/">前端</a><small>1</small></li>
  
    <li><a href="/tags/守护进程/">守护进程</a><small>1</small></li>
  
    <li><a href="/tags/性能/">性能</a><small>1</small></li>
  
    <li><a href="/tags/服务/">服务</a><small>1</small></li>
  
    <li><a href="/tags/未分类/">未分类</a><small>1</small></li>
  
    <li><a href="/tags/架构/">架构</a><small>1</small></li>
  
    <li><a href="/tags/测试/">测试</a><small>1</small></li>
  
    <li><a href="/tags/算法/">算法</a><small>2</small></li>
  
    <li><a href="/tags/算法、数据结构/">算法、数据结构</a><small>2</small></li>
  
    <li><a href="/tags/跨域/">跨域</a><small>1</small></li>
  
    <li><a href="/tags/队列/">队列</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 simon sun
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'simonsun';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>